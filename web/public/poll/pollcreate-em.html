<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FeedApp login</title>
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700" rel="stylesheet">
    <link rel="stylesheet" href="../style-em.css" />
</head>
<body>

    <div id="login_div" class="guest-div">
        <h1>Create Poll</h1>
        <input type="poll code" placeholder="Poll Question" id="poll_question_field"/><br>
        <input type="poll code" placeholder="First Answer" id="first_ans_field"/><br>
        <input type="poll code" placeholder="Second Answer" id="second_ans_field"/><br>

        <form action="/action_page.php">
            <label for="start">Select Start time:</label>
            <input type="date" id="start" name="day">
        </form>
        <form action="/action_page.php">
            <label for="end">Select End time:</label>
            <input type="date" id="end" name="day">
        </form>
        <!--
        <input type="poll code" placeholder="Start Time" id="start_time_field"/><br>
        <input type="poll code" placeholder="End Time" id="end_time_field"/><br>
        -->
        <input type="checkbox" id="private" name="private" value="private">
        <label for="private">Private</label><br>
        <!--<input type="submit">-->
        <button onclick="createPoll()" type="button">Create Poll</button>
    </div>

    <script>
        let url = 'http://localhost:8080';

        async function createPoll() {
            let pollQuestion = document.getElementById("poll_question_field");
            let firstAnswer = document.getElementById("first_ans_field");
            let secondAnswer = document.getElementById("second_ans_field");
            let startTime = document.getElementById("start");
            let endTime = document.getElementById("end");

            let pollBody = {
                "question":pollQuestion.value,
                "firstAnswer":firstAnswer.value,
                "secondAnswer":secondAnswer.value,
                "startTime":startTime.value,
                "endTime":endTime.value
            }

            if(pollQuestion.value === ""
                || firstAnswer.value === ""
                || secondAnswer.value === ""
                || startTime.value === ""
                || endTime.value === "") {
                alert("Please make sure to fill in all fields");
            }else{
                await pollPOST().then(response => {
                    console.log(response);
                }).catch(e => {
                    console.log(e);
                });
            }

            async function pollGET() {
                const response = await fetch(url + '/api/v1/polls/');
                const json = await response.json();
            }

            async function pollPOST() {
                const response = await fetch(url + '/api/v1/polls/create/', {
                    method: 'POST',
                    mode: 'cors',
                    body: pollBody,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const json = await response.json();
                console.log(json);
                return json;
            }
        }
    </script>



    <!--ThecoreFirebaseJSSDKisalwaysrequiredandmustbelistedfirst-->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-database.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-analytics.js"></script>

    <script>
        //Yourwebapp'sFirebaseconfiguration
        //ForFirebaseJSSDKv7.20.0andlater,measurementIdisoptional
        var firebaseConfig = {
            apiKey: "AIzaSyBVaiwbASOUfS4GoXaPYS62LgMaxsbSZG0",
            authDomain: "dat250-gr-2-h2020-app.firebaseapp.com",
            databaseURL: "https://dat250-gr-2-h2020-app.firebaseio.com",
            projectId: "dat250-gr-2-h2020-app",
            storageBucket: "dat250-gr-2-h2020-app.appspot.com",
            messagingSenderId: "851900401969",
            appId: "1:851900401969:web:32372ee6e94b18bbb4c810",
            measurementId: "G-03WHQEL0R0"
        };
        //InitializeFirebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
    <script src="pollvote-em.js"></script>

</body>
</html>